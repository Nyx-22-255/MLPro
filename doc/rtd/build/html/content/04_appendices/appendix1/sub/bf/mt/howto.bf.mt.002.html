<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Howto BF-MT-002: Multitasking - Tasks and Workflows &mdash; MLPro Documentations 1.0.0 documentation</title><link rel="stylesheet" href="../../../../../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../../../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../../../../../../_static/custom.css" type="text/css" /><link rel="shortcut icon" href="../../../../../../_static/favicon.ico"/>
  <!--[if lt IE 9]>
    <script src="../../../../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="../../../../../../" src="../../../../../../_static/documentation_options.js"></script>
        <script src="../../../../../../_static/jquery.js"></script>
        <script src="../../../../../../_static/underscore.js"></script>
        <script src="../../../../../../_static/doctools.js"></script>
        <script src="../../../../../../_static/language_data.js"></script>
        <script src="../../../../../../_static/clipboard.min.js"></script>
        <script src="../../../../../../_static/copybutton.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="../../../../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../../../search.html" />
    <link rel="next" title="Howto BF-MATH-001: Dimensions, Spaces and Elements" href="../math/howto.bf.math.001.html" />
    <link rel="prev" title="Howto BF-MT-001: Multitasking - Parallel Algorithms" href="howto.bf.mt.001.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../../../../index.html" class="icon icon-home"> MLPro Documentations<img src="../../../../../../_static/logo_mlpro.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Welcome to MLPro</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../01_welcome/sub/01_introduction.html">1. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../01_welcome/sub/02_getting_started.html">2. Getting Started</a></li>
</ul>
<p class="caption"><span class="caption-text">Basic Functions</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../02_basic_functions/mlpro_bf/main.html">7. MLPro-BF - Basic Functions</a></li>
</ul>
<p class="caption"><span class="caption-text">Machine Learning</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../../03_machine_learning/mlpro_sl/main.html">8. MLPro-SL - Supervised Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../03_machine_learning/mlpro_rl/main.html">9. MLPro-RL - Reinforcement Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../03_machine_learning/mlpro_gt/main.html">10. MLPro-GT - Game Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../../03_machine_learning/mlpro_oa/main.html">11. MLPro-OA - Online Adaptivity</a></li>
</ul>
<p class="caption"><span class="caption-text">Appendices</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../../../main.html">A1 - Example Pool</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../../01_howto.bf.html">Basic Functions</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../01_howto.bf.html#elementary-topics">Elementary Topics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../01_howto.bf.html#event-handling">Event Handling</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../01_howto.bf.html#multitasking">Multitasking</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="howto.bf.mt.001.html">Howto BF-MT-001: Multitasking - Parallel Algorithms</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Howto BF-MT-002: Multitasking - Tasks and Workflows</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../01_howto.bf.html#mathematics">Mathematics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../01_howto.bf.html#data-stream-processing">Data Stream Processing</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../01_howto.bf.html#machine-learning">Machine Learning</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../01_howto.bf.html#systems">Systems</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../01_howto.bf.html#user-interaction">User Interaction</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../02_howto.rl.html">Reinforcement Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../03_howto.gt.html">Game Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../04_howto.oa.html">Online Adaptivity</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../../appendix2/main.html">A2 - API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../appendix3/main.html">A3 - Project MLPro</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../../../index.html">MLPro Documentations</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../../main.html">A1 - Example Pool</a> &raquo;</li>
          <li><a href="../../01_howto.bf.html">Basic Functions</a> &raquo;</li>
      <li>Howto BF-MT-002: Multitasking - Tasks and Workflows</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://github.com/fhswf/MLPro/blob/main/doc/docs/content/04_appendices/appendix1/sub/bf/mt/howto.bf.mt.002.rst" class="fa fa-github"> Edit on GitHub</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="module-mlpro.bf.examples.howto_bf_mt_002_tasks_and_workflows">
<span id="howto-bf-mt-002-multitasking-tasks-and-workflows"></span><h1>Howto BF-MT-002: Multitasking - Tasks and Workflows<a class="headerlink" href="#module-mlpro.bf.examples.howto_bf_mt_002_tasks_and_workflows" title="Permalink to this headline">¶</a></h1>
<p>Ver. 1.3.1 (2022-11-07)</p>
<p>This module demonstrates the use of tasks and workflows as part of MLPro’s multitasking concept.
To this regard, a demo custom task class is implemented. At first the task class is instantiated 9
times, added to a workflow, and chained by predecessor relations. In two experiments the workflow is
executed synchronously and in multithreading mode. In the latter case, the tasks are partly executed
parallel which increases the computation performance.</p>
<p>In both experiments pseudo results are stored in a shared object.</p>
<p>You will learn:</p>
<ol class="arabic simple">
<li><p>How to implement an own custom task</p></li>
<li><p>How to store results in a shared object</p></li>
<li><p>How to add tasks to a workflow</p></li>
<li><p>How to run tasks and workflows in various ranges of asynchronicity</p></li>
</ol>
<div class="section" id="executable-code">
<h2>Executable code<a class="headerlink" href="#executable-code" title="Permalink to this headline">¶</a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">## -------------------------------------------------------------------------------------------------</span>
<span class="c1">## -- Project : MLPro - A Synoptic Framework for Standardized Machine Learning Tasks</span>
<span class="c1">## -- Package : mlpro.bf.examples</span>
<span class="c1">## -- Module  : howto_bf_mt_002_tasks_and_workflows.py</span>
<span class="c1">## -------------------------------------------------------------------------------------------------</span>
<span class="c1">## -- History :</span>
<span class="c1">## -- yyyy-mm-dd  Ver.      Auth.    Description</span>
<span class="c1">## -- 2022-10-04  1.0.0     DA       Creation/release</span>
<span class="c1">## -- 2022-10-09  1.1.0     DA       Simplification</span>
<span class="c1">## -- 2022-10-12  1.2.0     DA       Restructuring of demo steps</span>
<span class="c1">## -- 2022-10-13  1.3.0     DA       Simplification and reduction to multithreading</span>
<span class="c1">## -- 2022-11-07  1.3.1     DA       Minor correction</span>
<span class="c1">## -------------------------------------------------------------------------------------------------</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Ver. 1.3.1 (2022-11-07)</span>

<span class="sd">This module demonstrates the use of tasks and workflows as part of MLPro&#39;s multitasking concept.</span>
<span class="sd">To this regard, a demo custom task class is implemented. At first the task class is instantiated 9 </span>
<span class="sd">times, added to a workflow, and chained by predecessor relations. In two experiments the workflow is </span>
<span class="sd">executed synchronously and in multithreading mode. In the latter case, the tasks are partly executed </span>
<span class="sd">parallel which increases the computation performance.</span>

<span class="sd">In both experiments pseudo results are stored in a shared object.</span>

<span class="sd">You will learn:</span>

<span class="sd">1) How to implement an own custom task </span>

<span class="sd">2) How to store results in a shared object</span>

<span class="sd">3) How to add tasks to a workflow </span>

<span class="sd">4) How to run tasks and workflows in various ranges of asynchronicity</span>

<span class="sd">&quot;&quot;&quot;</span>



<span class="kn">from</span> <span class="nn">time</span> <span class="kn">import</span> <span class="n">sleep</span>
<span class="kn">from</span> <span class="nn">mlpro.bf.various</span> <span class="kn">import</span> <span class="n">Log</span>
<span class="kn">import</span> <span class="nn">mlpro.bf.mt</span> <span class="k">as</span> <span class="nn">mt</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timedelta</span>
<span class="kn">from</span> <span class="nn">cmath</span> <span class="kn">import</span> <span class="n">pi</span><span class="p">,</span> <span class="n">sin</span><span class="p">,</span> <span class="n">cos</span><span class="p">,</span> <span class="n">tan</span>
<span class="kn">import</span> <span class="nn">random</span>



<span class="c1">## -------------------------------------------------------------------------------------------------</span>
<span class="c1">## -------------------------------------------------------------------------------------------------</span>
<span class="k">class</span> <span class="nc">MyTask</span> <span class="p">(</span><span class="n">mt</span><span class="o">.</span><span class="n">Task</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Demo implementation of a task with custom method _run().</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># needed for proper logging (see class mlpro.bf.various.Log)</span>
    <span class="n">C_NAME</span>      <span class="o">=</span> <span class="s1">&#39;My task&#39;</span>

<span class="c1">## -------------------------------------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span> <span class="bp">self</span><span class="p">,</span> 
                  <span class="n">p_duration</span><span class="p">:</span><span class="n">timedelta</span><span class="p">,</span>
                  <span class="n">p_name</span><span class="p">:</span><span class="nb">str</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">p_range_max</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">Task</span><span class="o">.</span><span class="n">C_RANGE_THREAD</span><span class="p">,</span> 
                  <span class="n">p_autorun</span><span class="o">=</span><span class="n">mt</span><span class="o">.</span><span class="n">Task</span><span class="o">.</span><span class="n">C_AUTORUN_NONE</span><span class="p">,</span>
                  <span class="n">p_class_shared</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                  <span class="n">p_visualize</span><span class="p">:</span><span class="nb">bool</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">p_logging</span><span class="o">=</span><span class="n">Log</span><span class="o">.</span><span class="n">C_LOG_ALL</span> <span class="p">):</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span> <span class="n">p_name</span><span class="o">=</span><span class="n">p_name</span><span class="p">,</span>
                          <span class="n">p_range_max</span><span class="o">=</span><span class="n">p_range_max</span><span class="p">,</span> 
                          <span class="n">p_autorun</span><span class="o">=</span><span class="n">p_autorun</span><span class="p">,</span>
                          <span class="n">p_class_shared</span><span class="o">=</span><span class="n">p_class_shared</span><span class="p">,</span> 
                          <span class="n">p_visualize</span><span class="o">=</span><span class="n">p_visualize</span><span class="p">,</span>
                          <span class="n">p_logging</span><span class="o">=</span><span class="n">p_logging</span> <span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_duration</span> <span class="o">=</span> <span class="n">p_duration</span>

    
<span class="c1">## -------------------------------------------------------------------------------------------------</span>
    <span class="k">def</span> <span class="nf">_run</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">p_kwargs</span><span class="p">):</span>

        <span class="n">tid</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_tid</span><span class="p">()</span>
        
        <span class="c1"># 1 Dummy implementation to simulate a busy sub-task</span>
        <span class="n">time_start</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
        <span class="n">result</span>     <span class="o">=</span> <span class="mi">0</span>

        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="c1"># do something meaningful</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">500</span><span class="p">):</span> 
                <span class="n">result</span> <span class="o">+=</span> <span class="n">sin</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">cos</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span> <span class="o">*</span> <span class="n">tan</span><span class="p">(</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">()</span><span class="o">*</span><span class="n">pi</span><span class="p">)</span>

            <span class="n">time_current</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
            <span class="n">time_diff</span>    <span class="o">=</span> <span class="n">time_current</span> <span class="o">-</span> <span class="n">time_start</span>
            <span class="k">if</span> <span class="n">time_diff</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_duration</span><span class="p">:</span> <span class="k">break</span>

        <span class="c1"># 3 Sub-task can optionally store resuls in the shared object.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_so</span><span class="o">.</span><span class="n">add_result</span><span class="p">(</span><span class="n">p_tid</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">get_name</span><span class="p">(),</span> <span class="n">p_result</span><span class="o">=</span><span class="n">result</span><span class="p">)</span>





<span class="c1"># 1 Preparation of execution</span>
<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>  
    <span class="c1"># 1.1 Preparation for demo mode</span>
    <span class="n">duration</span>    <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">)</span>
    <span class="n">pause_sec</span>   <span class="o">=</span> <span class="mi">5</span>
    <span class="n">logging</span>     <span class="o">=</span> <span class="n">Log</span><span class="o">.</span><span class="n">C_LOG_ALL</span>

<span class="k">else</span><span class="p">:</span>
    <span class="c1"># 1.2 Preparation for unit test mode</span>
    <span class="n">num_tasks</span>   <span class="o">=</span> <span class="mi">2</span>
    <span class="n">duration</span>    <span class="o">=</span> <span class="n">timedelta</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">10000</span><span class="p">)</span>
    <span class="n">pause_sec</span>   <span class="o">=</span> <span class="mi">0</span>
    <span class="n">logging</span>     <span class="o">=</span> <span class="n">Log</span><span class="o">.</span><span class="n">C_LOG_NOTHING</span>



<span class="c1"># 2 Creation of a workflow with 9 tasks within</span>

<span class="c1"># 2.1 Creation of 9 tasks</span>
<span class="n">t1a</span> <span class="o">=</span> <span class="n">MyTask</span><span class="p">(</span> <span class="n">p_duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span> <span class="n">p_name</span><span class="o">=</span><span class="s1">&#39;t1a&#39;</span><span class="p">,</span> <span class="n">p_logging</span><span class="o">=</span><span class="n">logging</span> <span class="p">)</span>
<span class="n">t1b</span> <span class="o">=</span> <span class="n">MyTask</span><span class="p">(</span> <span class="n">p_duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span> <span class="n">p_name</span><span class="o">=</span><span class="s1">&#39;t1b&#39;</span><span class="p">,</span> <span class="n">p_logging</span><span class="o">=</span><span class="n">logging</span> <span class="p">)</span>
<span class="n">t1c</span> <span class="o">=</span> <span class="n">MyTask</span><span class="p">(</span> <span class="n">p_duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span> <span class="n">p_name</span><span class="o">=</span><span class="s1">&#39;t1c&#39;</span><span class="p">,</span> <span class="n">p_logging</span><span class="o">=</span><span class="n">logging</span> <span class="p">)</span>

<span class="n">t2a</span> <span class="o">=</span> <span class="n">MyTask</span><span class="p">(</span> <span class="n">p_duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span> <span class="n">p_name</span><span class="o">=</span><span class="s1">&#39;t2a&#39;</span><span class="p">,</span> <span class="n">p_logging</span><span class="o">=</span><span class="n">logging</span> <span class="p">)</span>
<span class="n">t2b</span> <span class="o">=</span> <span class="n">MyTask</span><span class="p">(</span> <span class="n">p_duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span> <span class="n">p_name</span><span class="o">=</span><span class="s1">&#39;t2b&#39;</span><span class="p">,</span> <span class="n">p_logging</span><span class="o">=</span><span class="n">logging</span> <span class="p">)</span>
<span class="n">t2c</span> <span class="o">=</span> <span class="n">MyTask</span><span class="p">(</span> <span class="n">p_duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span> <span class="n">p_name</span><span class="o">=</span><span class="s1">&#39;t2c&#39;</span><span class="p">,</span> <span class="n">p_logging</span><span class="o">=</span><span class="n">logging</span> <span class="p">)</span>

<span class="n">t3a</span> <span class="o">=</span> <span class="n">MyTask</span><span class="p">(</span> <span class="n">p_duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span> <span class="n">p_name</span><span class="o">=</span><span class="s1">&#39;t3a&#39;</span><span class="p">,</span> <span class="n">p_logging</span><span class="o">=</span><span class="n">logging</span> <span class="p">)</span>
<span class="n">t3b</span> <span class="o">=</span> <span class="n">MyTask</span><span class="p">(</span> <span class="n">p_duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span> <span class="n">p_name</span><span class="o">=</span><span class="s1">&#39;t3b&#39;</span><span class="p">,</span> <span class="n">p_logging</span><span class="o">=</span><span class="n">logging</span> <span class="p">)</span>
<span class="n">t3c</span> <span class="o">=</span> <span class="n">MyTask</span><span class="p">(</span> <span class="n">p_duration</span><span class="o">=</span><span class="n">duration</span><span class="p">,</span> <span class="n">p_name</span><span class="o">=</span><span class="s1">&#39;t3c&#39;</span><span class="p">,</span> <span class="n">p_logging</span><span class="o">=</span><span class="n">logging</span> <span class="p">)</span>

<span class="c1"># 2.2 Create a workflow and add the tasks</span>
<span class="n">wf</span> <span class="o">=</span> <span class="n">mt</span><span class="o">.</span><span class="n">Workflow</span><span class="p">(</span> <span class="n">p_name</span><span class="o">=</span><span class="s1">&#39;wf1&#39;</span><span class="p">,</span> 
                  <span class="n">p_range_max</span><span class="o">=</span><span class="n">mt</span><span class="o">.</span><span class="n">Workflow</span><span class="o">.</span><span class="n">C_RANGE_THREAD</span><span class="p">,</span> 
                  <span class="n">p_class_shared</span><span class="o">=</span><span class="n">mt</span><span class="o">.</span><span class="n">Shared</span><span class="p">,</span> 
                  <span class="n">p_logging</span><span class="o">=</span><span class="n">logging</span> <span class="p">)</span>

<span class="c1"># 2.2.1 At first we add three tasks that build the starting points of our workflow</span>
<span class="n">wf</span><span class="o">.</span><span class="n">add_task</span><span class="p">(</span> <span class="n">p_task</span><span class="o">=</span><span class="n">t1a</span> <span class="p">)</span>
<span class="n">wf</span><span class="o">.</span><span class="n">add_task</span><span class="p">(</span> <span class="n">p_task</span><span class="o">=</span><span class="n">t1b</span> <span class="p">)</span>
<span class="n">wf</span><span class="o">.</span><span class="n">add_task</span><span class="p">(</span> <span class="n">p_task</span><span class="o">=</span><span class="n">t1c</span> <span class="p">)</span>

<span class="c1"># 2.2.2 Then, we add three further tasks that shall start when their predecessor tasks have finished</span>
<span class="n">wf</span><span class="o">.</span><span class="n">add_task</span><span class="p">(</span> <span class="n">p_task</span><span class="o">=</span><span class="n">t2a</span><span class="p">,</span> <span class="n">p_pred_tasks</span><span class="o">=</span><span class="p">[</span><span class="n">t1a</span><span class="p">]</span> <span class="p">)</span>
<span class="n">wf</span><span class="o">.</span><span class="n">add_task</span><span class="p">(</span> <span class="n">p_task</span><span class="o">=</span><span class="n">t2b</span><span class="p">,</span> <span class="n">p_pred_tasks</span><span class="o">=</span><span class="p">[</span><span class="n">t1b</span><span class="p">]</span> <span class="p">)</span>
<span class="n">wf</span><span class="o">.</span><span class="n">add_task</span><span class="p">(</span> <span class="n">p_task</span><span class="o">=</span><span class="n">t2c</span><span class="p">,</span> <span class="n">p_pred_tasks</span><span class="o">=</span><span class="p">[</span><span class="n">t1c</span><span class="p">]</span> <span class="p">)</span>

<span class="c1"># 2.2.3 Finally, we add three further tasks that build the end of our task chains</span>
<span class="n">wf</span><span class="o">.</span><span class="n">add_task</span><span class="p">(</span> <span class="n">p_task</span><span class="o">=</span><span class="n">t3a</span><span class="p">,</span> <span class="n">p_pred_tasks</span><span class="o">=</span><span class="p">[</span><span class="n">t2a</span><span class="p">,</span> <span class="n">t2b</span><span class="p">,</span> <span class="n">t2c</span><span class="p">]</span> <span class="p">)</span>
<span class="n">wf</span><span class="o">.</span><span class="n">add_task</span><span class="p">(</span> <span class="n">p_task</span><span class="o">=</span><span class="n">t3b</span><span class="p">,</span> <span class="n">p_pred_tasks</span><span class="o">=</span><span class="p">[</span><span class="n">t2a</span><span class="p">,</span> <span class="n">t2b</span><span class="p">,</span> <span class="n">t2c</span><span class="p">]</span> <span class="p">)</span>
<span class="n">wf</span><span class="o">.</span><span class="n">add_task</span><span class="p">(</span> <span class="n">p_task</span><span class="o">=</span><span class="n">t3c</span><span class="p">,</span> <span class="n">p_pred_tasks</span><span class="o">=</span><span class="p">[</span><span class="n">t2a</span><span class="p">,</span> <span class="n">t2b</span><span class="p">,</span> <span class="n">t2c</span><span class="p">]</span> <span class="p">)</span>



<span class="c1"># 3 Run the workflow synchronously</span>
<span class="n">wf</span><span class="o">.</span><span class="n">run</span><span class="p">(</span> <span class="n">p_range</span><span class="o">=</span><span class="n">mt</span><span class="o">.</span><span class="n">Workflow</span><span class="o">.</span><span class="n">C_RANGE_NONE</span><span class="p">,</span> <span class="n">p_wait</span><span class="o">=</span><span class="kc">True</span> <span class="p">)</span>
<span class="n">wf</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">Log</span><span class="o">.</span><span class="n">C_LOG_TYPE_I</span><span class="p">,</span> <span class="s1">&#39;Result in shared object:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">wf</span><span class="o">.</span><span class="n">get_so</span><span class="p">()</span><span class="o">.</span><span class="n">get_results</span><span class="p">())</span>


<span class="c1"># 4 Clear result list in shared object and wait for next run (for better observation)</span>
<span class="n">wf</span><span class="o">.</span><span class="n">get_so</span><span class="p">()</span><span class="o">.</span><span class="n">clear_results</span><span class="p">()</span>
<span class="n">wf</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">Log</span><span class="o">.</span><span class="n">C_LOG_TYPE_W</span><span class="p">,</span> <span class="s1">&#39;Short break for better observation of CPU load in perfmeter&#39;</span><span class="p">)</span>
<span class="n">sleep</span><span class="p">(</span><span class="n">pause_sec</span><span class="p">)</span>



<span class="c1"># 5 Run the same workflow asynchronously in multithreading mode</span>
<span class="n">wf</span><span class="o">.</span><span class="n">run</span><span class="p">(</span> <span class="n">p_range</span><span class="o">=</span><span class="n">mt</span><span class="o">.</span><span class="n">Workflow</span><span class="o">.</span><span class="n">C_RANGE_THREAD</span><span class="p">,</span> <span class="n">p_wait</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">wf</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">Log</span><span class="o">.</span><span class="n">C_LOG_TYPE_I</span><span class="p">,</span> <span class="s1">&#39;Result in shared object:</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">wf</span><span class="o">.</span><span class="n">get_so</span><span class="p">()</span><span class="o">.</span><span class="n">get_results</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="section" id="results">
<h2>Results<a class="headerlink" href="#results" title="Permalink to this headline">¶</a></h2>
<p>The howto example logs details of the two runs (workflow synchronously/multithreading). A short break
between the workflow runs allows a better observation of CPU load in the system monitor.</p>
<img alt="../../../../../../_images/howto_bf_mt_002_tasks_and_workflows.png" src="../../../../../../_images/howto_bf_mt_002_tasks_and_workflows.png" />
</div>
</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="howto.bf.mt.001.html" class="btn btn-neutral float-left" title="Howto BF-MT-001: Multitasking - Parallel Algorithms" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../math/howto.bf.math.001.html" class="btn btn-neutral float-right" title="Howto BF-MATH-001: Dimensions, Spaces and Elements" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022 South Westphalia University of Applied Sciences, Germany.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>